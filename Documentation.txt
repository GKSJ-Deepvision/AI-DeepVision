Crowd Monitoring Project

ShanghaiTech Dataset : 
	
=> The dataset was proposed in the paper “Single‑Image Crowd Counting via Multi‑Column Convolutional Neural Network” (Zhang et al., 2016). 
=> It contains roughly 1,198 images in total with about 330,000 annotated head locations.
=> It is split into Part A and Part B:
      <> Part A: 482 images, higher crowd density (crawled from internet) 
      <> Part B: 716 images, lower to moderate density (busy streets of Shanghai) 
   Further, each part is divided into training and testing subsets and each subset contain images and ground-truth folders.
      <> images/        
	- Contains the crowd scene pictures — real images with many people.
      <> ground-truth/  
	- Contains the annotations for each image.
	- Each .mat file (MATLAB file) contains the coordinates of each person’s head position.

=> The folder structure looks like :
	ShanghaiTech/
    	    |-Part_A/
        	|-train_data/
            	     |-images/
            	     |-ground_truth/
        	|-test_data/
            	     |-images/
            	     |-ground_truth/
            |-Part_B/
        	|-train_data/
            	     |-images/
            	     |-ground_truth/
        	|-test_data/
            	     |-images/
                     |-ground_truth/

Preprocessing : 

=> Standardize image size  
	- All images resized to a uniform shape i.e., 512 × 512
=> Normalize color                     
	- Convert to RGB format for model compatibility 
=> Convert annotations → density maps  
	- Generate training labels as per density estimation 
=> Prepare `(image, density_map)` pair 
	- For DataLoader during training 
=> The flow : 
	Original Image (.jpg)
			|
	Resize + RGB Convert
			|
	Load Head Points (.mat)
			|
	Create Impulse Map
			|
	Apply Gaussian → Density Map
			|
	Save as .jpg + .npy
			|
	(image, density_map) pair ready

Data Visualization : 

=> Impulse Map
	- A blank matrix of size equal to the image where all values are 0 and each head coordinate is marked as 1
=> Density Map
	- Impulse map is converted into a smooth heatmap by applying a Gaussian filter
	- Sum of all values in density map ~ total number of people
=> Heat Map
	- Heatmap just applies a color mapping scheme over the density values.

- Image with annotated red head points that Confirms annotation correctness                  
- Impulse map to see Raw head locations visualized    
- Gaussian smoothed density map to Ground truth label for model training          
- Heatmap overlay on image to Realistic interpretation of density distribution 
